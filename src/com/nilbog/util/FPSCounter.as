package com.nilbog.util {	import com.nilbog.layout.Box;	import com.nilbog.layout.VerticalLayoutStrategy;	import com.nilbog.util.displayobject.FrameUpdater;	import com.nilbog.util.displayobject.UpdateEvent;	import com.nilbog.util.number.RollingAverage;	import com.nilbog.util.number.truncate;	import flash.display.Sprite;	import flash.system.System;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;	import flash.text.TextFormat;	/**	 * @author markhawley	 * 	 * A Sprite that shows the current avg FPS.	 */	public class FPSCounter extends Sprite	{		private var avgFPS:RollingAverage;				private var box:Box = new Box( new VerticalLayoutStrategy(1) );		private var fps:TextField = new TextField();		private var memory:TextField = new TextField();				/**		 * Constructor.		 */		public function FPSCounter( framesToAverage:uint=100 )		{			FrameUpdater.instance.addEventListener(UpdateEvent.UPDATE, onUpdate);			avgFPS = new RollingAverage( framesToAverage );						var format:TextFormat = new TextFormat();			format.font = "_typewriter";						fps.defaultTextFormat = format;			fps.autoSize = TextFieldAutoSize.LEFT;			fps.width = 300;			fps.selectable = false;			fps.text = "...";						memory.defaultTextFormat = format;			memory.autoSize = TextFieldAutoSize.LEFT;			memory.width = 300;			memory.selectable = false;			memory.text = "...";						addChild(box);			box.addChild(fps);			box.addChild(memory);		}				/**		 * Handler for UpdateEvents -- called once per frame, it updates		 * this text field with a rolling average of the last 10 FPS counts.		 */		private function onUpdate(event:UpdateEvent) :void		{				fps.text = truncate(avgFPS.update(event.fps), 0) + "fps";			memory.text = Math.round( System.totalMemory / (1024 * 1024) ) + " MB used";		}	}}